{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}Public Goods Game{% endblock %}

{% block content %}

    <h2>
        {% if treatment == 'choice_blindness' %}
            Please indicate how much you would like to contribute. 
        {% else %}
            How much will you contribute to the public good?
        {% endif %}
    </h2>

    <form method="post">
        {{ form.contribution }}
        <button type="submit">Submit</button>
    </form>

    {% if treatment == 'choice_overload' or treatment == 'both' %}
        <script>
            let timeLeft = {{ C.TIMEOUT_SECONDS }};
            const timerElement = document.createElement('p');
            timerElement.textContent = `Time remaining: ${timeLeft} seconds`;
            document.querySelector('form').parentNode.insertBefore(timerElement, document.querySelector('form').nextSibling);

            const countdown = setInterval(function() {
                timeLeft--;
                timerElement.textContent = `Time remaining: ${timeLeft} seconds`;
                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    document.querySelector('form').submit(); 
                }
            }, 1000);
        </script>
    {% endif %}
{% endblock %}