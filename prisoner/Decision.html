{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}Prisoner's Dilemma{% endblock %}

{% block content %}

    <h2>
        {% if group == 'choice_blindness' %}
            Please indicate whether you would cooperate or defect.
        {% else %}
            You and another person have been arrested for a crime. 
            You are being held in separate cells and cannot communicate with each other.
            The police lack evidence to convict you both on the main charge, so they offer you a deal:
            <br><br>
            * If you both remain silent (cooperate), you each serve 1 year in prison.
            * If you betray your partner (defect), while they remain silent, you go free and they serve 3 years.
            * If you both betray each other (defect), you each serve 2 years.
            <br><br>
            Choose whether to <strong>cooperate</strong> or <strong>defect</strong>.
        {% endif %}
    </h2>

    <form method="post">
        {{ formfield 'decision' }}
        <button type="submit">Submit</button>
    </form>

    {% if group == 'choice_overload' or group == 'both' %}
        <script>
            let timeLeft = {{ C.TIMEOUT_SECONDS }};
            const timerElement = document.createElement('p');
            timerElement.textContent = `Time remaining: ${timeLeft} seconds`; // Initial text

            const countdown = setInterval(function() {
                // ...
                timerElement.textContent = `Time remaining: ${timeLeft} seconds`; // Update text directly
                // ...
            }, 1000);
        </script>
    {% endif %}
{% endblock %}
